SELECT
    TRADER,

	CASE CUR_NO
        WHEN 1 THEN CURRENCY1
        WHEN 2 THEN CURRENCY2
    END AS CURRENCY,

    DEAL_TYPE,
    FAR_LEG,
    SUM(ABS(CUR1_AMOUNT))

FROM OrderPojo
    LEFT JOIN CONTRACTORS.Contractor as contractors ON OrderPojo.BUYER_LEGAL_ENTITY = contractors.ID_LE
    LEFT JOIN CONTRACTORS.Contractor as contractors2 ON OrderPojo.SELLER_LEGAL_ENTITY = contractors2.ID_LE
    CROSS JOIN (SELECT C1 CUR_NO FROM (VALUES (1), (2)) AS V) AS CURS

WHERE (contractors.ID_LE IS NOT NULL OR contractors2.ID_LE IS NOT NULL)

GROUP
	BY TRADER,
    CASE CUR_NO
        WHEN 1 THEN CURRENCY1
        WHEN 2 THEN CURRENCY2
	END,

	DEAL_TYPE,
    FAR_LEG