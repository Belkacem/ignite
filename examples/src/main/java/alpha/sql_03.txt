SELECT
    TRADER,

	CASE CUR_NO
        WHEN 1 THEN CURRENCY1
        WHEN 2 THEN CURRENCY2
    END AS CURRENCY,

    DEAL_TYPE,
    FAR_LEG,
    SUM(ABS(CUR1_AMOUNT))

FROM OrderPojo
    INNER JOIN CONTRACTORS.Contractor as contractors ON (OrderPojo.BUYER_LEGAL_ENTITY = contractors.ID_LE OR OrderPojo.SELLER_LEGAL_ENTITY = contractors.ID_LE)
    CROSS JOIN (SELECT C1 CUR_NO FROM (VALUES (1), (2)) AS V) AS CURS

GROUP BY
    TRADER,
    CASE CUR_NO
        WHEN 1 THEN CURRENCY1
        WHEN 2 THEN CURRENCY2
	END,

	DEAL_TYPE,
    FAR_LEG